import * as goggleLib from '../dist/index.js'

const lines = [
  `new goggleLib.Goggle([], {
    name: 'Some name',
    description: 'Some description',
    public: true,
})`,
  `new goggleLib.GoggleInstruction('pattern', {
        boost: 10,
        incontent: true,
        site: 'example.org',
})`,
  `new goggleLib.GoggleMeta('name', 'value')`,
  `new goggleLib.GoggleComment(' comment')`,
  `new goggleLib.GoggleEmpty()`,
]

const tableRows = lines.map((str) => {
  const line = eval(str)
  return `
<tr>
<td>

\`\`\`
${line.toString()}
\`\`\`

</td>
<td>

\`\`\`js
${str.replace('goggleLib.', '')}
\`\`\`

</td>
<td>

\`\`\`json
${JSON.stringify(line, null, 2)}
\`\`\`

</td>
</tr>`
})

const table = `
<!-- 
    THIS IS AN AUTOGENERATED AREA. DO NOT EDIT THIS AREA DIRECTLY.
    See \`scripts/generate-comparison-table.js\` for more information.
-->
<table>
<tr>
<th>Goggle</th>
<th>Goggledy</th>
<th>JSON</th>
</tr>
${tableRows.join('')}
</table>
`

// console.log(table)

// Read README.md and find the table and replace it with the new table
import fs from 'fs'

const readmePath = new URL('../README.md', import.meta.url)
const readme = fs.readFileSync(readmePath, 'utf8')
const newReadme = readme.replace(
  /<!-- START TABLE -->[\s\S]*<!-- END TABLE -->/,
  `<!-- START TABLE -->${table}<!-- END TABLE -->`,
)
fs.writeFileSync(readmePath, newReadme)
